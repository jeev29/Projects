{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/chiranjeevisrinivas/titanic-survival-prediction?scriptVersionId=125779767\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"641c7c99","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","execution":{"iopub.execute_input":"2023-04-14T11:52:50.21418Z","iopub.status.busy":"2023-04-14T11:52:50.212147Z","iopub.status.idle":"2023-04-14T11:52:57.012311Z","shell.execute_reply":"2023-04-14T11:52:57.009106Z"},"papermill":{"duration":6.810168,"end_time":"2023-04-14T11:52:57.017749","exception":false,"start_time":"2023-04-14T11:52:50.207581","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Loading required package: ggplot2\n","\n","Loading required package: lattice\n","\n","\n","Attaching package: ‘caret’\n","\n","\n","The following object is masked from ‘package:httr’:\n","\n","    progress\n","\n","\n","randomForest 4.6-14\n","\n","Type rfNews() to see new features/changes/bug fixes.\n","\n","\n","Attaching package: ‘randomForest’\n","\n","\n","The following object is masked from ‘package:ggplot2’:\n","\n","    margin\n","\n","\n","Loading required package: gsubfn\n","\n","Loading required package: proto\n","\n","Warning message:\n","“no DISPLAY variable so Tk is not available”\n","Loading required package: RSQLite\n","\n","\n","Attaching package: ‘dplyr’\n","\n","\n","The following object is masked from ‘package:randomForest’:\n","\n","    combine\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","── \u001b[1mAttaching packages\u001b[22m ─────────────────────────────────────── tidyverse 1.3.2 ──\n","\u001b[32m✔\u001b[39m \u001b[34mtibble \u001b[39m 3.1.8     \u001b[32m✔\u001b[39m \u001b[34mstringr\u001b[39m 1.5.0\n","\u001b[32m✔\u001b[39m \u001b[34mtidyr  \u001b[39m 1.2.1     \u001b[32m✔\u001b[39m \u001b[34mforcats\u001b[39m 0.5.2\n","\u001b[32m✔\u001b[39m \u001b[34mpurrr  \u001b[39m 1.0.1     \n","── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mcombine()\u001b[39m       masks \u001b[34mrandomForest\u001b[39m::combine()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m        masks \u001b[34mstats\u001b[39m::filter()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m           masks \u001b[34mstats\u001b[39m::lag()\n","\u001b[31m✖\u001b[39m \u001b[34mpurrr\u001b[39m::\u001b[32mlift()\u001b[39m          masks \u001b[34mcaret\u001b[39m::lift()\n","\u001b[31m✖\u001b[39m \u001b[34mrandomForest\u001b[39m::\u001b[32mmargin()\u001b[39m masks \u001b[34mggplot2\u001b[39m::margin()\n","\u001b[31m✖\u001b[39m \u001b[34mcaret\u001b[39m::\u001b[32mprogress()\u001b[39m      masks \u001b[34mhttr\u001b[39m::progress()\n","\u001b[1mRows: \u001b[22m\u001b[34m891\u001b[39m \u001b[1mColumns: \u001b[22m\u001b[34m12\u001b[39m\n","\u001b[36m──\u001b[39m \u001b[1mColumn specification\u001b[22m \u001b[36m────────────────────────────────────────────────────────\u001b[39m\n","\u001b[1mDelimiter:\u001b[22m \",\"\n","\u001b[31mchr\u001b[39m (5): Name, Sex, Ticket, Cabin, Embarked\n","\u001b[32mdbl\u001b[39m (7): PassengerId, Survived, Pclass, Age, SibSp, Parch, Fare\n","\n","\u001b[36mℹ\u001b[39m Use `spec()` to retrieve the full column specification for this data.\n","\u001b[36mℹ\u001b[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.\n","\u001b[1mRows: \u001b[22m\u001b[34m418\u001b[39m \u001b[1mColumns: \u001b[22m\u001b[34m11\u001b[39m\n","\u001b[36m──\u001b[39m \u001b[1mColumn specification\u001b[22m \u001b[36m────────────────────────────────────────────────────────\u001b[39m\n","\u001b[1mDelimiter:\u001b[22m \",\"\n","\u001b[31mchr\u001b[39m (5): Name, Sex, Ticket, Cabin, Embarked\n","\u001b[32mdbl\u001b[39m (6): PassengerId, Pclass, Age, SibSp, Parch, Fare\n","\n","\u001b[36mℹ\u001b[39m Use `spec()` to retrieve the full column specification for this data.\n","\u001b[36mℹ\u001b[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.\n"]},{"data":{"text/plain":["        Pclass\n","Survived   1   2   3\n","       0  64  90 270\n","       1 120  83  85"]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["          Reference\n","Prediction   0   1\n","         0 406 103\n","         1  18 185"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["'Accuracy = 0.83'"],"text/latex":["'Accuracy = 0.83'"],"text/markdown":["'Accuracy = 0.83'"],"text/plain":["[1] \"Accuracy = 0.83\""]},"metadata":{},"output_type":"display_data"}],"source":["library(\"readr\")\n","library(caret)\n","library(randomForest)\n","library('sqldf')\n","library('dplyr')\n","library('tidyverse')\n","library('stringr')\n","\n","train1 <- read_csv(\"/kaggle/input/titanic/train.csv\")\n","\n","train <- sqldf('select * from train1 where Age and Embarked is not null ')\n","\n","test <- read_csv(\"/kaggle/input/titanic/test.csv\")\n","\n","\n","train[c('First_name','middle_name', 'last_name')] <- str_split_fixed(train$Name, ' ', 3)\n","test[c('First_name','middle_name', 'last_name')] <- str_split_fixed(test$Name, ' ', 3)\n","\n","\n","\n","train$Survived <- as.factor(train$Survived)\n","train$Pclass <- as.factor(train$Pclass)\n","train$Sex <- as.factor(train$Sex)\n","train$Embarked <- as.factor(train$Embarked)\n","\n","train$middle_name <- as.factor(train$middle_name)\n","\n","\n","table(train[,c('Survived', 'Pclass')])\n","\n","set.seed(1111)\n","model <- randomForest(Survived~ Sex+Pclass+Embarked+middle_name, data = train, importance=TRUE, na.action = na.omit)\n","              \n","\n","prediction<- predict(model,train)\n","\n","conMat<- confusionMatrix(prediction, train$Survived) \n","conMat$table\n","paste('Accuracy =', round(conMat$overall[\"Accuracy\"],2))\n","\n","test$Pclass <- as.factor(test$Pclass)\n","test$Sex <- as.factor(test$Sex)\n","\n","test$Embarked <- factor(test$Embarked, levels = levels(train$Embarked))\n","test$middle_name <- factor(test$middle_name, levels = levels(train$middle_name))"]},{"cell_type":"code","execution_count":2,"id":"53a2cded","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","execution":{"iopub.execute_input":"2023-04-14T11:52:57.093787Z","iopub.status.busy":"2023-04-14T11:52:57.031668Z","iopub.status.idle":"2023-04-14T11:52:57.165935Z","shell.execute_reply":"2023-04-14T11:52:57.162104Z"},"papermill":{"duration":0.148532,"end_time":"2023-04-14T11:52:57.170613","exception":false,"start_time":"2023-04-14T11:52:57.022081","status":"completed"},"tags":[]},"outputs":[],"source":["#make prediction\n","RF_prediction <- predict(model, test)\n","submit <- data.frame(PassengerId = test$PassengerId, Survived = RF_prediction)\n","\n","write_csv(submit,\"submission.csv\")"]},{"cell_type":"code","execution_count":3,"id":"68ccedf9","metadata":{"execution":{"iopub.execute_input":"2023-04-14T11:52:57.183254Z","iopub.status.busy":"2023-04-14T11:52:57.181249Z","iopub.status.idle":"2023-04-14T11:52:57.210829Z","shell.execute_reply":"2023-04-14T11:52:57.208322Z"},"papermill":{"duration":0.039583,"end_time":"2023-04-14T11:52:57.214222","exception":false,"start_time":"2023-04-14T11:52:57.174639","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["0"],"text/latex":["0"],"text/markdown":["0"],"text/plain":["[1] 0"]},"metadata":{},"output_type":"display_data"}],"source":["sum(is.na(train$submit))\n"]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":11.338671,"end_time":"2023-04-14T11:52:57.342934","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2023-04-14T11:52:46.004263","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}