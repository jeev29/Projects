{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/chiranjeevisrinivas/titanic-r?scriptVersionId=117724511\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown","outputs":[],"execution_count":0},{"cell_type":"code","execution_count":1,"id":"5b337674","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","execution":{"iopub.execute_input":"2023-01-30T13:27:08.382197Z","iopub.status.busy":"2023-01-30T13:27:08.380063Z","iopub.status.idle":"2023-01-30T13:27:12.779577Z","shell.execute_reply":"2023-01-30T13:27:12.777781Z"},"papermill":{"duration":4.406357,"end_time":"2023-01-30T13:27:12.782145","exception":false,"start_time":"2023-01-30T13:27:08.375788","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Loading required package: ggplot2\n","\n","Loading required package: lattice\n","\n","\n","Attaching package: ‘caret’\n","\n","\n","The following object is masked from ‘package:httr’:\n","\n","    progress\n","\n","\n","randomForest 4.6-14\n","\n","Type rfNews() to see new features/changes/bug fixes.\n","\n","\n","Attaching package: ‘randomForest’\n","\n","\n","The following object is masked from ‘package:ggplot2’:\n","\n","    margin\n","\n","\n","\u001b[1mRows: \u001b[22m\u001b[34m891\u001b[39m \u001b[1mColumns: \u001b[22m\u001b[34m12\u001b[39m\n","\u001b[36m──\u001b[39m \u001b[1mColumn specification\u001b[22m \u001b[36m────────────────────────────────────────────────────────\u001b[39m\n","\u001b[1mDelimiter:\u001b[22m \",\"\n","\u001b[31mchr\u001b[39m (5): Name, Sex, Ticket, Cabin, Embarked\n","\u001b[32mdbl\u001b[39m (7): PassengerId, Survived, Pclass, Age, SibSp, Parch, Fare\n","\n","\u001b[36mℹ\u001b[39m Use `spec()` to retrieve the full column specification for this data.\n","\u001b[36mℹ\u001b[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.\n"]},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 6 × 12</caption>\n","<thead>\n","\t<tr><th scope=col>PassengerId</th><th scope=col>Survived</th><th scope=col>Pclass</th><th scope=col>Name</th><th scope=col>Sex</th><th scope=col>Age</th><th scope=col>SibSp</th><th scope=col>Parch</th><th scope=col>Ticket</th><th scope=col>Fare</th><th scope=col>Cabin</th><th scope=col>Embarked</th></tr>\n","\t<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>1</td><td>0</td><td>3</td><td>Braund, Mr. Owen Harris                            </td><td>male  </td><td>22</td><td>1</td><td>0</td><td>A/5 21171       </td><td> 7.2500</td><td>NA  </td><td>S</td></tr>\n","\t<tr><td>2</td><td>1</td><td>1</td><td>Cumings, Mrs. John Bradley (Florence Briggs Thayer)</td><td>female</td><td>38</td><td>1</td><td>0</td><td>PC 17599        </td><td>71.2833</td><td>C85 </td><td>C</td></tr>\n","\t<tr><td>3</td><td>1</td><td>3</td><td>Heikkinen, Miss. Laina                             </td><td>female</td><td>26</td><td>0</td><td>0</td><td>STON/O2. 3101282</td><td> 7.9250</td><td>NA  </td><td>S</td></tr>\n","\t<tr><td>4</td><td>1</td><td>1</td><td>Futrelle, Mrs. Jacques Heath (Lily May Peel)       </td><td>female</td><td>35</td><td>1</td><td>0</td><td>113803          </td><td>53.1000</td><td>C123</td><td>S</td></tr>\n","\t<tr><td>5</td><td>0</td><td>3</td><td>Allen, Mr. William Henry                           </td><td>male  </td><td>35</td><td>0</td><td>0</td><td>373450          </td><td> 8.0500</td><td>NA  </td><td>S</td></tr>\n","\t<tr><td>6</td><td>0</td><td>3</td><td>Moran, Mr. James                                   </td><td>male  </td><td>NA</td><td>0</td><td>0</td><td>330877          </td><td> 8.4583</td><td>NA  </td><td>Q</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 6 × 12\n","\\begin{tabular}{llllllllllll}\n"," PassengerId & Survived & Pclass & Name & Sex & Age & SibSp & Parch & Ticket & Fare & Cabin & Embarked\\\\\n"," <dbl> & <dbl> & <dbl> & <chr> & <chr> & <dbl> & <dbl> & <dbl> & <chr> & <dbl> & <chr> & <chr>\\\\\n","\\hline\n","\t 1 & 0 & 3 & Braund, Mr. Owen Harris                             & male   & 22 & 1 & 0 & A/5 21171        &  7.2500 & NA   & S\\\\\n","\t 2 & 1 & 1 & Cumings, Mrs. John Bradley (Florence Briggs Thayer) & female & 38 & 1 & 0 & PC 17599         & 71.2833 & C85  & C\\\\\n","\t 3 & 1 & 3 & Heikkinen, Miss. Laina                              & female & 26 & 0 & 0 & STON/O2. 3101282 &  7.9250 & NA   & S\\\\\n","\t 4 & 1 & 1 & Futrelle, Mrs. Jacques Heath (Lily May Peel)        & female & 35 & 1 & 0 & 113803           & 53.1000 & C123 & S\\\\\n","\t 5 & 0 & 3 & Allen, Mr. William Henry                            & male   & 35 & 0 & 0 & 373450           &  8.0500 & NA   & S\\\\\n","\t 6 & 0 & 3 & Moran, Mr. James                                    & male   & NA & 0 & 0 & 330877           &  8.4583 & NA   & Q\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 6 × 12\n","\n","| PassengerId &lt;dbl&gt; | Survived &lt;dbl&gt; | Pclass &lt;dbl&gt; | Name &lt;chr&gt; | Sex &lt;chr&gt; | Age &lt;dbl&gt; | SibSp &lt;dbl&gt; | Parch &lt;dbl&gt; | Ticket &lt;chr&gt; | Fare &lt;dbl&gt; | Cabin &lt;chr&gt; | Embarked &lt;chr&gt; |\n","|---|---|---|---|---|---|---|---|---|---|---|---|\n","| 1 | 0 | 3 | Braund, Mr. Owen Harris                             | male   | 22 | 1 | 0 | A/5 21171        |  7.2500 | NA   | S |\n","| 2 | 1 | 1 | Cumings, Mrs. John Bradley (Florence Briggs Thayer) | female | 38 | 1 | 0 | PC 17599         | 71.2833 | C85  | C |\n","| 3 | 1 | 3 | Heikkinen, Miss. Laina                              | female | 26 | 0 | 0 | STON/O2. 3101282 |  7.9250 | NA   | S |\n","| 4 | 1 | 1 | Futrelle, Mrs. Jacques Heath (Lily May Peel)        | female | 35 | 1 | 0 | 113803           | 53.1000 | C123 | S |\n","| 5 | 0 | 3 | Allen, Mr. William Henry                            | male   | 35 | 0 | 0 | 373450           |  8.0500 | NA   | S |\n","| 6 | 0 | 3 | Moran, Mr. James                                    | male   | NA | 0 | 0 | 330877           |  8.4583 | NA   | Q |\n","\n"],"text/plain":["  PassengerId Survived Pclass\n","1 1           0        3     \n","2 2           1        1     \n","3 3           1        3     \n","4 4           1        1     \n","5 5           0        3     \n","6 6           0        3     \n","  Name                                                Sex    Age SibSp Parch\n","1 Braund, Mr. Owen Harris                             male   22  1     0    \n","2 Cumings, Mrs. John Bradley (Florence Briggs Thayer) female 38  1     0    \n","3 Heikkinen, Miss. Laina                              female 26  0     0    \n","4 Futrelle, Mrs. Jacques Heath (Lily May Peel)        female 35  1     0    \n","5 Allen, Mr. William Henry                            male   35  0     0    \n","6 Moran, Mr. James                                    male   NA  0     0    \n","  Ticket           Fare    Cabin Embarked\n","1 A/5 21171         7.2500 NA    S       \n","2 PC 17599         71.2833 C85   C       \n","3 STON/O2. 3101282  7.9250 NA    S       \n","4 113803           53.1000 C123  S       \n","5 373450            8.0500 NA    S       \n","6 330877            8.4583 NA    Q       "]},"metadata":{},"output_type":"display_data"},{"name":"stderr","output_type":"stream","text":["\u001b[1mRows: \u001b[22m\u001b[34m418\u001b[39m \u001b[1mColumns: \u001b[22m\u001b[34m11\u001b[39m\n","\u001b[36m──\u001b[39m \u001b[1mColumn specification\u001b[22m \u001b[36m────────────────────────────────────────────────────────\u001b[39m\n","\u001b[1mDelimiter:\u001b[22m \",\"\n","\u001b[31mchr\u001b[39m (5): Name, Sex, Ticket, Cabin, Embarked\n","\u001b[32mdbl\u001b[39m (6): PassengerId, Pclass, Age, SibSp, Parch, Fare\n","\n","\u001b[36mℹ\u001b[39m Use `spec()` to retrieve the full column specification for this data.\n","\u001b[36mℹ\u001b[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.\n"]},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 6 × 11</caption>\n","<thead>\n","\t<tr><th scope=col>PassengerId</th><th scope=col>Pclass</th><th scope=col>Name</th><th scope=col>Sex</th><th scope=col>Age</th><th scope=col>SibSp</th><th scope=col>Parch</th><th scope=col>Ticket</th><th scope=col>Fare</th><th scope=col>Cabin</th><th scope=col>Embarked</th></tr>\n","\t<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>892</td><td>3</td><td>Kelly, Mr. James                            </td><td>male  </td><td>34.5</td><td>0</td><td>0</td><td>330911 </td><td> 7.8292</td><td>NA</td><td>Q</td></tr>\n","\t<tr><td>893</td><td>3</td><td>Wilkes, Mrs. James (Ellen Needs)            </td><td>female</td><td>47.0</td><td>1</td><td>0</td><td>363272 </td><td> 7.0000</td><td>NA</td><td>S</td></tr>\n","\t<tr><td>894</td><td>2</td><td>Myles, Mr. Thomas Francis                   </td><td>male  </td><td>62.0</td><td>0</td><td>0</td><td>240276 </td><td> 9.6875</td><td>NA</td><td>Q</td></tr>\n","\t<tr><td>895</td><td>3</td><td>Wirz, Mr. Albert                            </td><td>male  </td><td>27.0</td><td>0</td><td>0</td><td>315154 </td><td> 8.6625</td><td>NA</td><td>S</td></tr>\n","\t<tr><td>896</td><td>3</td><td>Hirvonen, Mrs. Alexander (Helga E Lindqvist)</td><td>female</td><td>22.0</td><td>1</td><td>1</td><td>3101298</td><td>12.2875</td><td>NA</td><td>S</td></tr>\n","\t<tr><td>897</td><td>3</td><td>Svensson, Mr. Johan Cervin                  </td><td>male  </td><td>14.0</td><td>0</td><td>0</td><td>7538   </td><td> 9.2250</td><td>NA</td><td>S</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 6 × 11\n","\\begin{tabular}{lllllllllll}\n"," PassengerId & Pclass & Name & Sex & Age & SibSp & Parch & Ticket & Fare & Cabin & Embarked\\\\\n"," <dbl> & <dbl> & <chr> & <chr> & <dbl> & <dbl> & <dbl> & <chr> & <dbl> & <chr> & <chr>\\\\\n","\\hline\n","\t 892 & 3 & Kelly, Mr. James                             & male   & 34.5 & 0 & 0 & 330911  &  7.8292 & NA & Q\\\\\n","\t 893 & 3 & Wilkes, Mrs. James (Ellen Needs)             & female & 47.0 & 1 & 0 & 363272  &  7.0000 & NA & S\\\\\n","\t 894 & 2 & Myles, Mr. Thomas Francis                    & male   & 62.0 & 0 & 0 & 240276  &  9.6875 & NA & Q\\\\\n","\t 895 & 3 & Wirz, Mr. Albert                             & male   & 27.0 & 0 & 0 & 315154  &  8.6625 & NA & S\\\\\n","\t 896 & 3 & Hirvonen, Mrs. Alexander (Helga E Lindqvist) & female & 22.0 & 1 & 1 & 3101298 & 12.2875 & NA & S\\\\\n","\t 897 & 3 & Svensson, Mr. Johan Cervin                   & male   & 14.0 & 0 & 0 & 7538    &  9.2250 & NA & S\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 6 × 11\n","\n","| PassengerId &lt;dbl&gt; | Pclass &lt;dbl&gt; | Name &lt;chr&gt; | Sex &lt;chr&gt; | Age &lt;dbl&gt; | SibSp &lt;dbl&gt; | Parch &lt;dbl&gt; | Ticket &lt;chr&gt; | Fare &lt;dbl&gt; | Cabin &lt;chr&gt; | Embarked &lt;chr&gt; |\n","|---|---|---|---|---|---|---|---|---|---|---|\n","| 892 | 3 | Kelly, Mr. James                             | male   | 34.5 | 0 | 0 | 330911  |  7.8292 | NA | Q |\n","| 893 | 3 | Wilkes, Mrs. James (Ellen Needs)             | female | 47.0 | 1 | 0 | 363272  |  7.0000 | NA | S |\n","| 894 | 2 | Myles, Mr. Thomas Francis                    | male   | 62.0 | 0 | 0 | 240276  |  9.6875 | NA | Q |\n","| 895 | 3 | Wirz, Mr. Albert                             | male   | 27.0 | 0 | 0 | 315154  |  8.6625 | NA | S |\n","| 896 | 3 | Hirvonen, Mrs. Alexander (Helga E Lindqvist) | female | 22.0 | 1 | 1 | 3101298 | 12.2875 | NA | S |\n","| 897 | 3 | Svensson, Mr. Johan Cervin                   | male   | 14.0 | 0 | 0 | 7538    |  9.2250 | NA | S |\n","\n"],"text/plain":["  PassengerId Pclass Name                                         Sex    Age \n","1 892         3      Kelly, Mr. James                             male   34.5\n","2 893         3      Wilkes, Mrs. James (Ellen Needs)             female 47.0\n","3 894         2      Myles, Mr. Thomas Francis                    male   62.0\n","4 895         3      Wirz, Mr. Albert                             male   27.0\n","5 896         3      Hirvonen, Mrs. Alexander (Helga E Lindqvist) female 22.0\n","6 897         3      Svensson, Mr. Johan Cervin                   male   14.0\n","  SibSp Parch Ticket  Fare    Cabin Embarked\n","1 0     0     330911   7.8292 NA    Q       \n","2 1     0     363272   7.0000 NA    S       \n","3 0     0     240276   9.6875 NA    Q       \n","4 0     0     315154   8.6625 NA    S       \n","5 1     1     3101298 12.2875 NA    S       \n","6 0     0     7538     9.2250 NA    S       "]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["        Pclass\n","Survived   1   2   3\n","       0  80  97 372\n","       1 136  87 119"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<style>\n",".dl-inline {width: auto; margin:0; padding: 0}\n",".dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}\n",".dl-inline>dt::after {content: \":\\0020\"; padding-right: .5ex}\n",".dl-inline>dt:not(:first-of-type) {padding-left: .5ex}\n","</style><dl class=dl-inline><dt>PassengerId</dt><dd>'numeric'</dd><dt>Survived</dt><dd>'factor'</dd><dt>Pclass</dt><dd>'factor'</dd><dt>Name</dt><dd>'character'</dd><dt>Sex</dt><dd>'factor'</dd><dt>Age</dt><dd>'numeric'</dd><dt>SibSp</dt><dd>'factor'</dd><dt>Parch</dt><dd>'factor'</dd><dt>Ticket</dt><dd>'character'</dd><dt>Fare</dt><dd>'numeric'</dd><dt>Cabin</dt><dd>'character'</dd><dt>Embarked</dt><dd>'factor'</dd></dl>\n"],"text/latex":["\\begin{description*}\n","\\item[PassengerId] 'numeric'\n","\\item[Survived] 'factor'\n","\\item[Pclass] 'factor'\n","\\item[Name] 'character'\n","\\item[Sex] 'factor'\n","\\item[Age] 'numeric'\n","\\item[SibSp] 'factor'\n","\\item[Parch] 'factor'\n","\\item[Ticket] 'character'\n","\\item[Fare] 'numeric'\n","\\item[Cabin] 'character'\n","\\item[Embarked] 'factor'\n","\\end{description*}\n"],"text/markdown":["PassengerId\n",":   'numeric'Survived\n",":   'factor'Pclass\n",":   'factor'Name\n",":   'character'Sex\n",":   'factor'Age\n",":   'numeric'SibSp\n",":   'factor'Parch\n",":   'factor'Ticket\n",":   'character'Fare\n",":   'numeric'Cabin\n",":   'character'Embarked\n",":   'factor'\n","\n"],"text/plain":["PassengerId    Survived      Pclass        Name         Sex         Age \n","  \"numeric\"    \"factor\"    \"factor\" \"character\"    \"factor\"   \"numeric\" \n","      SibSp       Parch      Ticket        Fare       Cabin    Embarked \n","   \"factor\"    \"factor\" \"character\"   \"numeric\" \"character\"    \"factor\" "]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["          Reference\n","Prediction   0   1\n","         0 416  54\n","         1   8 234"]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["'Accuracy = 0.91'"],"text/latex":["'Accuracy = 0.91'"],"text/markdown":["'Accuracy = 0.91'"],"text/plain":["[1] \"Accuracy = 0.91\""]},"metadata":{},"output_type":"display_data"}],"source":["      \n","\n","library(\"readr\")\n","library(caret)\n","library(randomForest)\n","\n","train <- read_csv(\"/kaggle/input/titanic/train.csv\")\n","head(train)\n","test <- read_csv(\"/kaggle/input/titanic/test.csv\")\n","head(test)\n","\n","\n","\n","train$Survived <- as.factor(train$Survived)\n","train$Pclass <- as.factor(train$Pclass)\n","train$Sex <- as.factor(train$Sex)\n","train$SibSp <- as.factor(train$SibSp)\n","train$Parch <- as.factor(train$Parch)\n","train$Embarked <- as.factor(train$Embarked)\n","train$Fare <- as.numeric(train$Fare)\n","\n","table(train[,c('Survived', 'Pclass')])\n","sapply(train,class)\n","set.seed(1111)\n","model <- randomForest(Survived~ Pclass +Sex+ Age+Fare+Embarked, data = train, importance=TRUE, na.action = na.omit)\n","              \n","\n","prediction<- predict(model,train)\n","\n","conMat<- confusionMatrix(prediction, train$Survived) \n","conMat$table\n","paste('Accuracy =', round(conMat$overall[\"Accuracy\"],2))\n","\n","test$Pclass <- as.factor(test$Pclass)\n","test$Sex <- as.factor(test$Sex)\n","test$SibSp <- as.factor(test$SibSp)\n","test$Parch <- as.factor(test$Parch)\n","test$Embarked <- as.factor(test$Embarked)\n","test$Fare <- as.numeric(test$Fare)\n","\n","\n","\n","\n"]},{"cell_type":"code","execution_count":2,"id":"27e297da","metadata":{"execution":{"iopub.execute_input":"2023-01-30T13:27:12.819411Z","iopub.status.busy":"2023-01-30T13:27:12.790449Z","iopub.status.idle":"2023-01-30T13:27:12.876071Z","shell.execute_reply":"2023-01-30T13:27:12.874221Z"},"papermill":{"duration":0.093458,"end_time":"2023-01-30T13:27:12.879098","exception":false,"start_time":"2023-01-30T13:27:12.78564","status":"completed"},"tags":[]},"outputs":[],"source":["#make prediction\n","RF_prediction <- predict(model, test)\n","submit <- data.frame(PassengerId = test$PassengerId, Survived = RF_prediction)\n","write_csv(submit,\"submit.csv\")\n"]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":8.097274,"end_time":"2023-01-30T13:27:13.002492","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2023-01-30T13:27:04.905218","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}